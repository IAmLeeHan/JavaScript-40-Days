<html>
<head>
  <title>Evernote Export</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600388 (zh-CN, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="773"/>

<div>
<span><div><div><span>课程概要</span></div><ol><li><div><span>Web应用安全发展与介绍</span></div></li><li><div><span style="font-size: 14px;">XSS入门及介绍</span></div></li><li><div><span style="font-size: 14px;">XSS的分类</span></div></li><li><div><span style="font-size: 14px;">XSS漏洞修复</span></div></li></ol><div><br/></div><div><font style="font-size: 18px;"><span style="font-size: 18px; font-weight: bold;">一、Web应用安全发展与介绍</span></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 14px;">接下来将通过以下三个方面来带大家了解这个圈子，初步认识Web安全</font></div><div><font style="font-size: 14px;">    1、安全与安全圈</font></div><div><font style="font-size: 14px;">    2、Web应用与Web安全的发展</font></div><div><font style="font-size: 14px;">    3、Web安全隐患与本质</font></div></div><div><img src="day13_Web安全介绍与基础入门知识_files/Image.png" type="image/png" data-filename="Image.png" style="font-weight: bold; font-size: 18px;" width="625"/></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>1、1990年代初，部分人开始研究黑客技术，比如马化腾</div><div>2、1997-1999年，黑客团队涌现，进入黄金时代</div><div>3、21世纪初，黑客工具傻瓜化，门槛降低，黑客精神不在...</div><div>4、今天，希望是安全的春天...</div></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 14px;">甲方和乙方</font></div><div><font style="font-size: 14px;">1、甲方，如腾讯、阿里等需要安全服务公司</font></div><div><font style="font-size: 14px;">2、乙方，提供安全服务、产品的服务型安全公司</font></div><div><br/></div><div><font style="font-size: 14px;">Web与二进制</font></div><div><font style="font-size: 14px;">1、Web，研究Web安全</font></div><div><font style="font-size: 14px;">2、二进制，研究如客户端安全等</font></div></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 14px;">那些圈内熟知的安全公司</font></div><div><font style="font-size: 14px;">绿盟、知道创宇、安天、启明星辰、安恒、天融信...</font></div></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 18px;"><b>Web安全</b></font><font style="font-size: 14px;">，也可以叫做Web应用安全。互联网本来是安全的，自从有了研究安全的人之后，互联网就变的不安全了。</font></div></div><div><img src="day13_Web安全介绍与基础入门知识_files/Image [1].png" type="image/png" data-filename="Image.png" width="709"/></div><div><img src="day13_Web安全介绍与基础入门知识_files/Image [2].png" type="image/png" data-filename="Image.png" width="711"/></div><div><img src="day13_Web安全介绍与基础入门知识_files/Image [3].png" type="image/png" data-filename="Image.png" width="707"/></div><div><br/></div><div><font style="font-size: 18px;"><span style="font-size: 18px; font-weight: bold;">二、XSS入门及介绍</span></font></div><div><font style="font-size: 18px;"><span style="font-size: 18px; font-weight: bold;">1、XSS的入门与介绍</span></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco; color: rgb(51, 51, 51);"><font style="font-size: 14px;"><b>什么是跨域脚本攻击？</b></font></span></div><div><span style="color: rgb(51, 51, 51); font-family: arial, 宋体, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 28px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-weight: bold;">    XSS攻击全称</span><a href="https://baike.baidu.com/item/%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB/8186208" style="color: rgb(19, 110, 194); font-family: arial, 宋体, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 28px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); font-weight: bold;">跨站脚本攻击</a><span style="color: rgb(51, 51, 51); font-family: arial, 宋体, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 28px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-weight: bold;">，是为不和层叠样式表(Cascading Style Sheets, CSS)的缩写混淆，故将跨站脚本攻击缩写为XSS，XSS是一种在web应用中的计算机安全漏洞，它允许恶意web用户将代码植入到提供给其它用户使用的页面中。</span></div><div><span style="color: rgb(51, 51, 51); font-family: arial, 宋体, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 28px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-weight: bold;">    当有用户访问这些网站，这些网站就会执行恶意植入的这些代码，发动攻击，最终达到获取用户信息的效果。</span></div><div><span style="color: rgb(51, 51, 51); font-family: arial, 宋体, sans-serif; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 28px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-weight: bold;"><font size="3">   </font> <font style="font-size: 18px;">【注】是一种注入式的攻击方式。</font></span></div></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 14px;"><b>XSS成因</b></font></div><div><font style="font-size: 14px;">1、对于用户输入没有严格控制而直接输出到页面</font></div><div><font style="font-size: 14px;">2、对非预期输入的信任</font></div><div><span style="font-family: Monaco; color: rgb(51, 51, 51); font-size: 14px; font-weight: bold;">XSS漏洞的危害</span></div><div><span style="color: rgb(51, 51, 51);">1、盗取各类用户账号，如机器登录账号、用户网银账号、各类管理员账号。</span></div><div><span style="color: rgb(51, 51, 51);">2、窃取数据</span></div><div><span style="color: rgb(51, 51, 51);">3、非法转账</span></div><div><span style="color: rgb(51, 51, 51);">4、挂马</span></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>…</div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">    XSS攻击是Web攻击中最常见的攻击方法之一，它是通过对网页注入可执行代码且成功地被浏览器</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">执行，达到攻击的目的，形成了一次有效XSS攻击，一旦攻击成功，它可以获取用户的联系人列</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">表，然后向联系人发送虚假诈骗信息，可以删除用户的日志等等，有时候还和其他攻击方式同时实</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">施比如SQL注入攻击服务器和数据库、Click劫持、相对链接劫持等实施钓鱼，它带来的危害是巨</span></div><div><span style="font-family: Monaco; font-size: 12px; color: rgb(51, 51, 51);">大的，是web安全的头号大敌。</span></div></div><div><img src="day13_Web安全介绍与基础入门知识_files/Image [4].png" type="image/png" data-filename="Image.png" style="font-weight: bold; font-size: 18px;" width="714"/></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco; color: rgb(51, 51, 51); font-size: 14px; font-weight: bold;">XSS跨站脚本实例</span></div><div><span style="font-weight: bold; font-family: Monaco; color: rgb(51, 51, 51);"><font style="font-size: 14px;">实施XSS攻击需要具备两个条件：</font></span></div><div><span style="font-family: Monaco;color: rgb(51, 51, 51);-en-paragraph:true;"><font style="font-size: 14px;">1、需要向web页面注入恶意代码；</font></span></div><div><span style="font-family: Monaco;color: rgb(51, 51, 51);-en-paragraph:true;"><font style="font-size: 14px;">2、这些恶意代码能够被浏览器成功的执行。</font></span></div></div><div><br/></div><div><img src="day13_Web安全介绍与基础入门知识_files/Image [5].png" type="image/png" data-filename="Image.png" width="440"/></div><div><img src="day13_Web安全介绍与基础入门知识_files/Image [6].png" type="image/png" data-filename="Image.png" style="font-weight: bold;" width="440"/></div><div><img src="day13_Web安全介绍与基础入门知识_files/Image [7].png" type="image/png" data-filename="Image.png" width="435"/></div><div><br/></div><div><font style="font-size: 18px;"><span style="font-size: 18px; font-weight: bold;">三、XSS的分类</span></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco; color: rgb(51, 51, 51);"><font style="font-size: 14px;">了解即可，不必细究，XSS根源就是没完全过滤客户端提交的数据</font></span></div></div><div><span style="font-size: 18px;"><span style="font-size: 18px; font-weight: bold;">2.1反射型xss攻击</span></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco; color: rgb(51, 51, 51);"><font style="font-size: 14px;">又称为非持久性跨站点脚本攻击，它是最常见的类型的XSS。漏洞产生的原因是攻击者注入的数据反映在响应中。一个典型的非持久性XSS包含一个带XSS攻击向量的链接(即每次攻击需要用户的点击)。</font></span></div></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><b><font size="3">简</font><font style="font-size: 14px;">单案例：</font></b></div><div><span style="font-family: Monaco;color: rgb(51, 51, 51);-en-paragraph:true;">正常发送消息：</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><a href="http://localhost/xss/01.php" style="color: rgb(4, 51, 255); font-variant-caps: normal; line-height: normal; font-family: Monaco; font-size: 12px;">http://localhost/xss/01.php</a><span style="color: #0433ff; font-variant-caps: normal; line-height: normal; font-family: Monaco; font-size: 12px;">?</span><span style="color: #0433ff; font-variant-caps: normal; line-height: normal; font-family: Monaco; font-size: 12px;">send=helloworld</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-family: Monaco;color: rgb(51, 51, 51);-en-paragraph:true;">接收者将会接收信息并显示Hello,Word</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-family: Monaco;color: rgb(51, 51, 51);-en-paragraph:true;">非正常发送消息：</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><font style="color: rgb(4, 51, 255);"><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal; font-family: Monaco; font-size: 12px;"><a href="http://localhost/xss/01.php" style="color: rgb(4, 51, 255);">http://localhost/xss/01.php</a></span><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal; font-family: Monaco; font-size: 12px;">?</span><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal; font-family: Monaco; font-size: 12px;">send=&lt;script&gt;alert</span><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal; font-family: Monaco; font-size: 12px;">(</span><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal; font-family: Monaco; font-size: 12px;">'XSS</span><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal; font-family: Monaco; font-size: 12px;">攻击</span><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal; font-family: Monaco; font-size: 12px;">'</span><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal; font-family: Monaco; font-size: 12px;">)</span><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal; font-family: Monaco; font-size: 12px;">&lt;/script&gt;</span><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal; font-family: Monaco; font-size: 12px;">!</span></font></div><div><span style="font-family: Monaco;color: rgb(51, 51, 51);-en-paragraph:true;">接收者接收消息显示的时候将会弹出警告窗口</span></div></div><div><br/></div><div><font style="font-size: 18px;"><span style="font-size: 18px; font-weight: bold;">2.2存储型xss攻击</span></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 14px;">    又称为持久型跨站点脚本，它一般发生在XSS攻击向量(一般指XSS攻击代码)存储在网站数据库，当一个页面被用户打开的时候执行。每当用户打开浏览器,脚本执行。持久的XSS相比非持久性XSS攻击危害性更大,因为每当用户打开页面，查看内容时脚本将自动执行。谷歌的orkut曾经就遭受到XSS。</font></div></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 14px; font-weight: bold;">简</span><span style="font-size: 14px; font-weight: bold;">单案例</span></div><div><br/></div><div><span style="font-family: Monaco;color: rgb(51, 51, 51);font-size: 12px;-en-paragraph:true;">    </span><span style="font-family: Monaco;color: rgb(51, 51, 51);font-size: 14px;-en-paragraph:true;">从名字就可了解到存储型XSS攻击就是将攻击代码存入数据库中，然后客户端打开时就执行这些攻击代码。例如留言板</span></div><div><span style="font-size: 14px;font-family: Monaco;color: rgb(51, 51, 51);-en-paragraph:true;">留言板表单中的表单域：</span><span style="font-size: 14px;font-family: Monaco;color: rgb(0, 144, 14);-en-paragraph:true;">&lt;input type=“text” name=“content” value=“这里是用户填写的数据”&gt;</span></div><div><br/></div><div><span style="font-size: 14px; font-family: Monaco; font-weight: bold;">正常操作</span></div><div><span style="font-size: 14px; font-family: Monaco; font-weight: bold;">  </span> <span style="font-size: 14px; font-family: Monaco;"> </span><span style="font-size: 14px; font-family: Monaco; color: rgb(51, 51, 51);">用户是提交相应留言信息；将数据存储到数据库；其他用户访问留言板，应用去数据并显示。</span></div><div><br/></div><div><span style="font-size: 14px; font-family: Monaco; font-weight: bold;">非正常操作</span></div><div><span style="font-family: Monaco; font-weight: bold; font-size: 14px;">    </span><span style="font-family: Monaco;font-size: 14px;-en-paragraph:true;">攻击者在value填写</span><span style="font-family: Monaco;color: rgb(0, 176, 14);font-size: 14px;-en-paragraph:true;">&lt;script&gt;alert(‘XSS攻击')&lt;/script&gt;</span><span style="font-family: Monaco;font-size: 14px;-en-paragraph:true;">【或者html其他标签（破坏样式。。。）、一段攻击型代码】；</span></div><div><span style="font-family: Monaco;color: rgb(51, 51, 51);font-size: 14px;font-weight: bold;-en-paragraph:true;">将数据存储到数据库中；</span></div><div><span style="font-family: Monaco; color: rgb(51, 51, 51); font-size: 14px; font-weight: bold;">其他用户取出数据显示的时候，将会执行这些攻击性代码</span></div></div><div><br/></div><div><font style="font-size: 18px;"><span style="font-size: 18px; font-weight: bold;">2.3DOMBasedXSS（基于dom的跨站点脚本攻击）</span></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco;color: rgb(51, 51, 51);-en-paragraph:true;"><font style="font-size: 14px;">    基于DOM的XSS有时也称为type0XSS。当用户能够通过交互修改浏览器页面中的DOM(DocumentObjectModel)并显示在浏览器上时，就有可能产生这种漏洞，从效果上来说它也是反射型XSS。</font></span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-family: Monaco;color: rgb(51, 51, 51);-en-paragraph:true;"><font style="font-size: 14px;">　　通过修改页面的DOM节点形成的XSS，称之为DOMBasedXSS。</font></span></div><div><span style="font-family: Monaco;color: rgb(51, 51, 51);-en-paragraph:true;"><font style="font-size: 14px;">　　前提是易受攻击的网站有一个HTML页面采用不安全的方式从document.location 或document.URL 或 document.referrer获取数据（或者任何其他攻击者可以修改的对象）。</font></span></div></div><div><img src="day13_Web安全介绍与基础入门知识_files/Image [8].png" type="image/png" data-filename="Image.png" width="509"/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco; color: rgb(51, 51, 51);"><font style="font-size: 14px;">这个例子是个欢迎页面，name是截取URL中get过来的name参数</font></span></div><div><span style="font-weight: bold;font-family: Monaco;color: rgb(51, 51, 51);-en-paragraph:true;"><font style="font-size: 14px;">正常操作：</font></span></div><div><a href="http://localhost/xss/03index.html?name=Jack" style="font-family: Monaco;"><font color="#0433FF" style="font-family: Monaco; font-size: 14px;">http://localhost/xss/03index.html?name=Jack</font></a></div><div><span style="font-weight: bold; font-family: Monaco; color: rgb(51, 51, 51);"><font style="font-size: 14px;">非正常操作：</font></span></div><div><a href="http://localhost/xss/03index.html?name=%3Cscript%3Ealert(document.cookie)%3C/script%3E" style="font-weight: bold; font-family: Monaco; color: rgb(51, 51, 51);"><font style="font-size: 14px;"><font face="Monaco"><b>http://localhost/xss/03index.html?name=</b></font><span style="font-weight: bold; font-family: Monaco; color: rgb(51, 51, 51);">&lt;script&gt;alert(document.cookie)&lt;/script&gt;</span></font></a></div><div><span style="font-weight: bold;font-family: Monaco;color: rgb(51, 51, 51);-en-paragraph:true;"><font style="font-size: 14px;">注意:</font></span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-family: Monaco;color: rgb(51, 51, 51);-en-paragraph:true;"><font style="font-size: 14px;">　　1. 恶意程序脚本在任何时候不会嵌入到处于自然状态下的HTML页面（这和其他种类的xss不太一样）。</font></span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-family: Monaco;color: rgb(51, 51, 51);-en-paragraph:true;"><font style="font-size: 14px;">　　2.这个攻击只有在浏览器没有修改URL字符时起作用。 当url不是直接在地址栏输入，Mozilla.会自动转换在document.URL中字符&lt;和&gt;（转化为%3C 和 %3E），因此在就不会受到上面示例那样的攻击了，在IE6下没有转换&lt;和&gt;，因此他很容易受到攻击。</font></span></div><div><span style="font-family: Monaco;color: rgb(51, 51, 51);-en-paragraph:true;"><font style="font-size: 14px;">　　当然，直接嵌入到HTML只是攻击的一个挂载点，有很多脚本不需要依赖&lt;和&gt;漏洞，因此Mozilla通常也是无法阻止这些攻击的。</font></span></div></div><div><br/></div><div><font style="font-size: 18px;"><span style="font-size: 18px; font-weight: bold;">四、XSS漏洞修复</span></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco;"><font size="3" style="color: rgb(51, 51, 51);">    从上面</font><font style="font-size: 14px;">XSS实例以及之前文章的介绍我们知道XSS漏洞的起因就是没有对用户提交的数据进行严格的过滤处理。因此在思考解决XSS漏洞的时候，<font color="#FF2600">我们应该重点把握如何才能更好的将用户提交的数据进行安全过滤。</font></font></span></div></div><div><br/></div><div><font style="font-size: 18px;"><span style="font-size: 18px; font-weight: bold;">4.1HTML实体</span></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco;color: rgb(51, 51, 51);-en-paragraph:true;"><font style="font-size: 14px;"><b>什么是html实体？</b></font></span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-family: Monaco;color: rgb(51, 51, 51);-en-paragraph:true;"><font style="font-size: 14px;">　　在html中有些字符，像(&lt;)这类的，对HTML(标准通用标记语言下的一个应用)来说是有特殊意义的，所以这些字符是不允许在文本中使用的。要在HTML中显示(&lt;)这个字符，我们就必须使用实体字符。</font></span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-family: Monaco;color: rgb(51, 51, 51);-en-paragraph:true;"><font style="font-size: 14px;">　　html实体的存在是导致XSS漏洞的主要原因之一。</font></span></div><div><span style="font-family: Monaco;color: rgb(51, 51, 51);-en-paragraph:true;"><font style="font-size: 14px;">　　因此我们需要将这些实体全部转换为相应的实体编号。</font></span></div></div><div><img src="day13_Web安全介绍与基础入门知识_files/Image [9].png" type="image/png" data-filename="Image.png" style="font-weight: bold; font-size: 18px;" width="520"/></div><div><br/></div><div><font style="font-size: 18px;"><span style="font-size: 18px; font-weight: bold;">4.2HTML Encode</span></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco;color: rgb(51, 51, 51);-en-paragraph:true;"><font size="3">用户将</font><font style="font-size: 14px;">数据提交上来的时候进行HTML编码，将相应的符号转换为实体名称再进行下一步的处理。</font></span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-family: Monaco;-en-paragraph:true;"><font style="font-size: 14px;">在PHP中已经存在这样子功能的函数，即是<b><font style="color: rgb(4, 51, 255);">htmlentities($str)</font></b>函数。</font></span></div><div><span style="font-family: Monaco;-en-paragraph:true;"><font style="font-size: 14px;">与之相反的就是<font style="color: rgb(4, 51, 255);"><b>html_entity_decode($str)</b></font>函数，它将实体名称转换为相应的符号。</font></span></div></div><div><br/></div><div><font style="font-size: 18px;"><span style="font-size: 18px; font-weight: bold;">4.3修复方针</span></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font color="#FF2600"><span style="font-family: Monaco;-en-paragraph:true;"><font size="3">【不相应用</font><font style="font-size: 14px;">户提交的数据，</font></span><font style="font-size: 14px;"><span style="font-weight: bold;font-family: Monaco;-en-paragraph:true;">过滤过滤过滤！</span><span style="font-family: Monaco;-en-paragraph:true;">】</span></font></font></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-family: Monaco;color: rgb(51, 51, 51);-en-paragraph:true;"><font style="font-size: 14px;">1、将重要的cookie标记为http only, 这样的话Javascript 中的document.cookie语句就不能获取到cookie了.</font></span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-family: Monaco;color: rgb(51, 51, 51);-en-paragraph:true;"><font style="font-size: 14px;">2、表单数据规定值的类型，例如：年龄应为只能为int、name只能为字母数字组合。。。。</font></span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-family: Monaco;color: rgb(51, 51, 51);-en-paragraph:true;"><font style="font-size: 14px;">4、对数据进行Html Encode 处理</font></span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-family: Monaco;color: rgb(51, 51, 51);-en-paragraph:true;"><font style="font-size: 14px;">5、过滤或移除特殊的Html标签， 例如: &lt;script&gt;, &lt;iframe&gt; , &amp;lt; for &lt;, &amp;gt; for &gt;, &amp;quot for</font></span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-family: Monaco;color: rgb(51, 51, 51);-en-paragraph:true;"><font style="font-size: 14px;">6、过滤JavaScript 事件的标签。例如 &quot;onclick=&quot;, &quot;onfocus&quot; 等等。</font></span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-family: Monaco;color: rgb(51, 51, 51);-en-paragraph:true;"><font style="font-size: 14px;">【特别注意：】</font></span></div><div><span style="font-family: Monaco;color: rgb(51, 51, 51);-en-paragraph:true;"><font style="font-size: 14px;">在有些应用中是允许html标签出现的，甚至是javascript代码出现。因此我们在过滤数据的时候需要仔细分析哪些数据是有特殊要求（例如输出需要html代码、javascript代码拼接、或者此表单直接允许使用等等），然后区别处理！</font></span></div></div><div><br/></div><div><font style="font-size: 18px;"><span style="font-size: 18px; font-weight: bold;">4.4PHP中处理XSS攻击的函数（本质是过滤数据）</span></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco;color: rgb(51, 51, 51);-en-paragraph:true;"><font style="font-size: 14px;"><b>【详细看PHP<font>手册】</font></b></font></span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-family: Monaco;color: rgb(51, 51, 51);-en-paragraph:true;"><font style="font-size: 14px;"><b>这里可能不全，想了解更多的看手册。</b></font></span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-family: Monaco;color: rgb(51, 51, 51);-en-paragraph:true;"><font style="font-size: 14px;">strip_tags($str, [允许标签])  #从字符串中去除 HTML 和 PHP 标记</font></span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-family: Monaco;color: rgb(51, 51, 51);-en-paragraph:true;"><font style="font-size: 14px;">htmlentities($str)函数    #转义html实体</font></span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-family: Monaco;color: rgb(51, 51, 51);-en-paragraph:true;"><font style="font-size: 14px;">html_entity_decode($str)函数    #反转义html实体</font></span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-family: Monaco;color: rgb(51, 51, 51);-en-paragraph:true;"><font style="font-size: 14px;">addcslashes($str, ‘字符’)函数     #给某些字符加上反斜杠</font></span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-family: Monaco;color: rgb(51, 51, 51);-en-paragraph:true;"><font style="font-size: 14px;">stripcslashes($str)函数          #去掉反斜杠</font></span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-family: Monaco;color: rgb(51, 51, 51);-en-paragraph:true;"><font style="font-size: 14px;">addslashes ($str )函数          #单引号、双引号、反斜线与 NULL加反斜杠</font></span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-family: Monaco;color: rgb(51, 51, 51);-en-paragraph:true;"><font style="font-size: 14px;">stripslashes($str)函数           #去掉反斜杠</font></span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-family: Monaco;color: rgb(51, 51, 51);-en-paragraph:true;"><font style="font-size: 14px;">htmlspecialchars()              #特殊字符转换为HTML实体</font></span></div><div><span style="font-family: Monaco;color: rgb(51, 51, 51);-en-paragraph:true;"><font style="font-size: 14px;">htmlspecialchars_decode()       #将特殊的 HTML 实体转换回普通字符</font></span></div></div><div><br/></div><div><span style="font-size: 18px; font-weight: bold;">五、跨域伪造请求（CSRF）</span></div><div style="word-break: break-word;"><h2><span style="font-weight: bold; line-height: 1.5; font-size: 18px;">5.1Session简单介绍</span></h2><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>    <font style="font-size: 14px;">在WE</font><font style="font-size: 14px;">B开发中，服务器可以为每个用户浏览器创建一个会话对象（session对象），注意：一个浏览器独占一个session对象(默认情况下)。因此，在需要保存用户数据时，服务器程序可以把用户数据写到用户浏览器独占的session中，当用户使用浏览器访问其它程序时，其它程序可以从用户的session中取出该用户的数据，为用户服务。</font></div></div><h2><span style="font-weight: bold; line-height: 1.5; font-size: 18px;">5.2Session和Cookie的主要区别</span></h2><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>* Cookie是把用户的数据写给用户的浏览器。(长期会员)</div><div>* Session技术把用户的数据写到用户独占的session中。（临时卡）</div><div>* Session对象由服务器创建，开发人员可以调用request对象的getSession方法得到session对象。</div></div></div><div><br/></div><div><span style="font-size: 18px; font-weight: bold;">5.3CSRF攻击原理</span></div><div><img src="day13_Web安全介绍与基础入门知识_files/Image [10].png" type="image/png" data-filename="Image.png" style="font-weight: bold; font-size: 18px;" width="499"/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="color: rgb(68, 68, 68); font-family: &quot;Open Sans&quot;, &quot;Helvetica Neue&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">CSRF是什么呢？CSRF全名是Cross-site request forgery，是一种对网站的恶意利用，CSRF比XSS更具危险性。想要深入理解CSRF的攻击特性我们有必要了解一下网站session的工作原理。 </span></div><div><br style="color: rgb(68, 68, 68); font-family: &quot;Open Sans&quot;, &quot;Helvetica Neue&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"/></div><div><span style="color: rgb(68, 68, 68); font-family: &quot;Open Sans&quot;, &quot;Helvetica Neue&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　session我想大家都不陌生，无论你用.net或PHP开发过网站的都肯定用过session对象，然而session它是如何工作的呢？如果你不清楚请往下看。 </span></div><div><span style="color: rgb(68, 68, 68); font-family: &quot;Open Sans&quot;, &quot;Helvetica Neue&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">先问个小问题：如果我把浏览器的cookie禁用了，大家认为session还能正常工作吗？ </span></div><div><br style="color: rgb(68, 68, 68); font-family: &quot;Open Sans&quot;, &quot;Helvetica Neue&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"/></div><div><span style="color: rgb(68, 68, 68); font-family: &quot;Open Sans&quot;, &quot;Helvetica Neue&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　答案是否定的，我在这边举个简单的例子帮助大家理解session。 </span></div><div><span style="color: rgb(68, 68, 68); font-family: 'Open Sans', 'Helvetica Neue', 'Hiragino Sans GB', 'WenQuanYi Micro Hei', 'Microsoft Yahei', sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">比如我买了一张高尔夫俱乐部的会员卡，俱乐部给了我一张带有卡号的会员卡。我能享受哪些权利（比如我是高级会员卡可以打19洞和后付费喝饮料，而初级会员卡只能在练习场挥杆）以及我的个人资料都是保存在高尔夫俱乐部的数据库里的。我每次去高尔夫俱乐部只需要出示这张高级会员卡，俱乐部就知道我是谁了，并且为我服务了。</span></div><div><br style="color: rgb(68, 68, 68); font-family: &quot;Open Sans&quot;, &quot;Helvetica Neue&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"/></div><div><span style="color: rgb(68, 68, 68); font-family: 'Open Sans', 'Helvetica Neue', 'Hiragino Sans GB', 'WenQuanYi Micro Hei', 'Microsoft Yahei', sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">　　这里我们的高级会员卡卡号 = 保存在cookie的sessionid； </span></div><div><span style="color: rgb(68, 68, 68); font-family: &quot;Open Sans&quot;, &quot;Helvetica Neue&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">而我的高级会员卡权利和个人信息就是服务端的session对象了。 </span></div><div><br style="color: rgb(68, 68, 68); font-family: &quot;Open Sans&quot;, &quot;Helvetica Neue&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"/></div><div><span style="color: rgb(68, 68, 68); font-family: 'Open Sans', 'Helvetica Neue', 'Hiragino Sans GB', 'WenQuanYi Micro Hei', 'Microsoft Yahei', sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">　　我们知道http请求是无状态的，也就是说每次http请求都是独立的无关之前的操作的，但是每次http请求都会将本域下的所有cookie作为http请求头的一部分发送给服务端，所以服务端就根据请求中的cookie存放的sessionid去session对象中找到该会员资料了。 </span></div><div><span style="color: rgb(68, 68, 68); font-family: 'Open Sans', 'Helvetica Neue', 'Hiragino Sans GB', 'WenQuanYi Micro Hei', 'Microsoft Yahei', sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">当然session的保存方法多种多样，可以保存在文件中，也可以内存里，考虑到分布式的横向扩展我们还是建议把它保存在第三方媒介中，比如redis或者mongodb。 </span></div><div><span style="color: rgb(68, 68, 68); font-family: 'Open Sans', 'Helvetica Neue', 'Hiragino Sans GB', 'WenQuanYi Micro Hei', 'Microsoft Yahei', sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">我们理解了session的工作机制后，CSRF也就很容易理解了。CSRF攻击就相当于恶意用户A复制了我的高级会员卡，哪天恶意用户A也可以拿着这张假冒的高级会员卡去高尔夫俱乐部打19洞，享受美味的饮料了，而我在月底就会收到高尔夫俱乐部的账单！ </span></div><div><br style="color: rgb(68, 68, 68); font-family: &quot;Open Sans&quot;, &quot;Helvetica Neue&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"/></div><div><span style="color: rgb(68, 68, 68); font-family: 'Open Sans', 'Helvetica Neue', 'Hiragino Sans GB', 'WenQuanYi Micro Hei', 'Microsoft Yahei', sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">　　了解CSRF的机制之后，危害性我相信大家已经不言而喻了，我可以伪造某一个用户的身份给其好友发送垃圾信息，这些垃圾信息的超链接可能带有木马程序或者一些欺骗信息（比如借钱之类的），如果CSRF发送的垃圾信息还带有蠕虫链接的话，那些接收到这些有害信息的好友万一打开私信中的连接就也成为了有害信息的散播着，这样数以万计的用户被窃取了资料种植了木马。整个网站的应用就可能在瞬间奔溃，用户投诉，用户流失，公司声誉一落千丈甚至面临倒闭。曾经在MSN上，一个美国的19岁的小伙子利用css的<span style="color: rgb(68, 68, 68); font-family: 'Open Sans', 'Helvetica Neue', 'Hiragino Sans GB', 'WenQuanYi Micro Hei', 'Microsoft Yahei', sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">Samy</span>background漏洞几小时内让100多万用户成功的感染了他的蠕虫，虽然这个蠕虫并没有破坏整个应用，只是在每一个用户的签名后面都增加了一句“Samy 是我的偶像”，但是一旦这些漏洞被恶意用户利用，后果将不堪设想，同样的事情也曾经发生在新浪微博上面。 </span></div><div><br style="color: rgb(68, 68, 68); font-family: &quot;Open Sans&quot;, &quot;Helvetica Neue&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"/></div><div><span style="color: rgb(68, 68, 68); font-family: 'Open Sans', 'Helvetica Neue', 'Hiragino Sans GB', 'WenQuanYi Micro Hei', 'Microsoft Yahei', sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">　　举例： </span></div><div><span style="color: rgb(68, 68, 68); font-family: 'Open Sans', 'Helvetica Neue', 'Hiragino Sans GB', 'WenQuanYi Micro Hei', 'Microsoft Yahei', sans-serif; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">　　CSRF攻击的主要目的是让用户在不知情的情况下攻击自己已登录的一个系统，类似于钓鱼。如用户当前已经登录了邮箱，或bbs，同时用户又在使用另外一个，已经被你控制的站点，我们姑且叫它钓鱼网站。这个网站上面可能因为某个图片吸引你，你去点击一下，此时可能就会触发一个js的点击事件，构造一个bbs发帖的请求，去往你的bbs发帖，由于当前你的浏览器状态已经是登陆状态，所以session登陆cookie信息都会跟正常的请求一样，纯天然的利用当前的登陆状态，让用户在不知情的情况下，帮你发帖或干其他事情。</span></div></div><div><br/></div><div><br/></div><div><font style="font-size: 18px;"><span style="font-size: 18px; font-weight: bold;">5.4CSRF防御</span></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco; color: rgb(51, 51, 51);"><font style="font-size: 14px;">1、通过 referer、token 或者 验证码 来检测用户提交。</font></span></div><div style="padding: 0px; list-style: disc inside;"><span style="font-family: Monaco; color: rgb(51, 51, 51);"><font style="font-size: 14px;">2、尽量不要在页面的链接中暴露用户隐私信息。</font></span></div><div style="padding: 0px; list-style: disc inside;"><span style="font-family: Monaco; color: rgb(51, 51, 51);"><font style="font-size: 14px;">3、对于用户修改删除等操作最好都使用post 操作 。</font></span></div><div><span style="font-family: Monaco; color: rgb(51, 51, 51);"><font style="font-size: 14px;">4、避免全站通用的cookie，严格设置cookie的域。</font></span></div></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div></div></span>
</div></body></html> 